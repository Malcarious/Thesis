\chapter{ALI Software Commands}

\section{List of Commands}
\label{sec:B.1:SoftwareCommands}

Following is a list of the commands that can be used in the ALI software for operational control during flight through the ground based communication program. A complete list will be presented then a description of each function will follow and are all case sensitive.

\begin{enumerate}
    \item \texttt{EnableScience}
    \item \texttt{DisableScience}
    \item \texttt{EnableRF}
    \item \texttt{DisableRF}
    \item \texttt{EnableAutoSendStats}
    \item \texttt{DisableAutoSendStats}
    \item \texttt{SetScienceMode}
    \item \texttt{ReloadConfig}
    \item \texttt{LdCusCnf}
    \item \texttt{LdCusExp}
    \item \texttt{GetFile}
    \item \texttt{EndCurrentScienceCycle}
    \item \texttt{SetExposureScaleFactor}
    \item \texttt{UpdateExposureTimeCurve}
    \item \texttt{EnableCheckRfTemps}
    \item \texttt{DisableCheckRfTemps}
    \item \texttt{ResetHousekeeping}
    \item \texttt{DumpConfig}
    \item \texttt{SetBitsPerSecond}
    \item \texttt{EnableAutomation}
    \item \texttt{DisableAutomation}
    \item \texttt{SetAutomationTimeout}
    \item \texttt{EnableGps}
    \item \texttt{DisableGps}
    \item \texttt{EnablePulse}
    \item \texttt{DisablePulse}
\end{enumerate}

\subsection{Command:EnableScience}

Full Command: \texttt{EnableScience}\\

This command enables science data acquisition and enables the RF driver. If the current mode is invalid the systems reports the error to the user. By default science mode data acquisition is disabled and must be enabled.

\subsection{Command:DisableScience}

Full Command: \texttt{DisableScience}\\

This command disables science data acquisition at the end of the current science mode cycle. This mode does not disable the RF driver. Current mode will not end if the RF driver is currently disabled as disabling the RF driver only pauses the cycle. By default science data acquisition is disabled.

\subsection{Command:EnableRF}

Full Command: \texttt{EnableRF}\\

Turns on the RF driver by enabling the relay that controls the power to the device. Heavy power draw and by default is disabled.

\subsection{Command:DisableRF}

Full Command: \texttt{DisbaleRF}\\

Disable the RF driver during science mode accusation. This only pauses the science acquisition cycle mode and will continue once the driver is enabled again. By default the RF driver is disabled due to the high power draw.

\subsection{Command:EnableAutoSendStats}

Full Command: \texttt{EnableAutoSendStats}

Enables the sending of statistics for each image taken and include 5 vertical columns of measured data from the image, what percentage of the CCD well is full as well as exposure time length, time taken, location, RF power, and wavelength. By default enabled.

\subsection{Command:DisableAutoSendStats}

Full Command: \texttt{DisableAutoSendStats}\\

Disables the sending of statistics for each image taken. By default enabled.

\subsection{Command:SetScienceMode}

Full Command: \texttt{SetScienceMode scienceMode,exposureMode}

Parameter: \texttt{scienceMode} is a numerical value of the science mode to be run.

Parameter: \texttt{exposureMode} is a numerical value of the science mode to be run.\\

Allows the user to change science mode and exposure modes that ALI is preforming. The science mode is a predetermined cycle of images to perform a specific scientific goal and a table containing all of the modes is listed \autoref{tab:B.2:ScienceModes} and a complete description of each cycle is presenting in \autoref{sec:B.2:ScienceModes}. The exposure mode is a predetermined exposure time lnegth to be used for each wavelength and a table containing all of the modes is listed \autoref{tab:B.3:ExposureModes} and a complete description of each mode is presenting in \autoref{sec:B.3:ExposureModes}. The next mode will be loaded once the current mode is complete. By default the program is set in Invalid Mode,Invalid Mode.

\subsection{Command:ReloadConfig}

Full Command: \texttt{ReloadConfig}\\

Upon completion of the current science cycle the current science mode cycle will be reload from the configuration files.

\subsection{Command:LdCusCnf}

Full Command: \texttt{LdCusCnf IsOneExp,NumExp,wavelegth,RFPower\ldots}

Parameter: \texttt{IsOneExp} is either a 0 or a 1. A 0 represents each exposure will have a different exposure time where a 1 represents that the exposure time used for the first image will be the same for all images.

Parameter: \texttt{NumExp} is the number of exposures the custom science mode will contain

Parameter: \texttt{wavelength,RFPower\ldots} is a pair of information for each image in the cycle as defined by \texttt{NumExp} consisting of a wavelength in nanometers and a RF power ranging from 0 to 1.\\

Uploads values for a custom science mode. The first value is the number of exposures followed by a number of pairs that equal the number of exposures with the pair set of wavelength in nanometers and RF Power. There is no check on the command apart from the right number of inputs. User must verify that the wavelength range is in between 600 and 1000~nm and the RF power is between 0 and 1.

\subsection{Command:LdCusExp}

Full Command: \texttt{LdCusExp numTimes,time\ldots}

Parameter: \texttt{numTimes} is the number of exposure time to be entered.

Parameter: \texttt{time\ldots} is a series of times in seconds separated by commas to match the number of exposure times.\\

Uploads values for a custom exposure time length series. The first value is the number of exposures time followed by a series of time in seconds. If custom exposure time is used the number o exposures must match the number of times or an error is sent to the user.

\subsection{Command:GetFile}

Full Command: \texttt{GetFile filename}

Parameter: \texttt{filename} is the image file to be downloaded from ALI with the full path.\\

Gets the requested image file from ALI-OCELOT if it exists.

\subsection{Command:EndCurrentScienceCycle}

Full Command: \texttt{EndCurrentScienceCycle}\\

Ends the current science operation mode immediately.

\subsection{Command:SetExposureScaleFactor}

Full Command: \texttt{SetExposureScaleFactor scaleFactor}

Parameter: \texttt{scaleFactor} is a number greater zero that scales the default calibrated exposure time curve seen in \autoref{TODO}.\\

Sets a scaling factor for the exposure times. Value must be greater than zero. Default is 1.0.

\subsection{Command:UpdateExposureTimeCurve}

Full Command: \texttt{UpdateExposureTimeCurve time\ldots}

Parameter: \texttt{time\ldots} is a series of 13 times separated by commas with minimum values of 0.05 seconds and a maximum of 60 seconds. The 13 values correspond to wavelengths rom 650-950~nm in 25~nm intervals.\\

This function changes the default values in the calibrated exposure time curve. Default values can be seen in \autoref{TODO}.

\subsection{Command:EnableCheckRfTemps}

Full Command: \texttt{EnableCheckRfTemps}\\

Enables a check to verify that the RF driver is not operating outside its temperature range. At 0 degrees Celsius the RF driver is powered on and at 50 degrees it is powered off. By default the check is enabled.

\subsection{Command:DisableCheckRfTemps}

Full Command: \texttt{DisableCheckRfTemps}\\

Disables the previous mentioned check for the RF driver. By default the check is enabled and it is not recommenced unless a problem with the sensors occurs.

\subsection{Command:ResetHousekeeping}

Full Command: \texttt{ResetHouseKeeping}\\

Resets the housekeeping module to reacquire the voltage and temperature sensors. To be used in case of problem with the housekeeping module occurs.

\subsection{Command:DumpConfig}

Full Command: \texttt{DumpConfig}\\

Prints the current configuration loaded into the science module. Used for debuging purposes.

\subsection{Command:SetBitsPerSecond}

Full Command: \texttt{SetBitsPerSecond bitsPerSecond}

Parameter: \texttt{bitsPerSecond} is the value to change the download speed to during operation in bits per second.\\

Changes the bitrate limit for the ALI operation program. Minimum value is 32000 bits per second ad the default is 50000 bits for second.

\subsection{Command:EnableAutomation}

Full Command: \texttt{EnableAutomation}\\

Enables the automatic timeout process in case of a loss of communication during the launch. Enabled by default and after 90 minutes puts the system in aerosol mode.

\subsection{Command:DisableAutomation}

Full Command: \texttt{DisablAutomation}\\

Stops the process that automatically starts ALI in an aerosol mode science operation after 90 minutes. This process should be disabled if the user has control of the system at float altitude.

\subsection{Command:SetAutomationTimeout}

Full Command: \texttt{SetAutomationTimeout time}

Parameter: \texttt{time} is the new time in minutes to set the timeout value.\\

Changes the default timeout time to the time given in minutes. Default is 90, Minimum is 5 and maximum is 240 minutes.

\subsection{Command:EnableGps}

Full Command: \texttt{EnableGps}\\

Starts the GPS process if it is not already started.

\subsection{Command:DisableGps}

Full Command: \texttt{DisableGps}\\

Stops the GPS process if it is not currently running.

\subsection{Command:EnablePulse}

Full Command: \texttt{EnablePulse}\\

Starts the pulse per second process if it is not already started.

\subsection{Command:DisablePulse}

Full Command: \texttt{DisbalePulse}\\

Stops the pulse per second process if it is not currently running.

\section{List of Science Modes}
\label{sec:B.2:ScienceModes}

The following section will give a brief description of each of the programmed science operational modes that exist on the ALI platform. A complete Table of the modes can be seen in \autoref{tab:B.2:ScienceModes}.

\begin{table}
    \begin{center}
    \begin{tabular}{|l|l|}
    \hline
    Mode Number & Mode Name \\
    \hline
    0 & Invalid Mode \\
    \hline
    1 & Dark Mode \\
    \hline
    2 & Aerosol Mode \\
    \hline
    3 & H$_{2}$O Mode \\
    \hline
    4 & O$_{2}$ Mode \\
    \hline
    5 & Custom Mode \\
    \hline
    6 & Aerosol Constant Exposure Time Mode \\
    \hline
    \end{tabular}
    \end{center}
    \caption[ALI Operational Science Modes]{ALI operational science modes.}
    \label{tab:B.2:ScienceModes}
\end{table}

\subsection{Invalid Mode}

This mode is a nonexistent mode that has no operationial function and will not allow the science module to operate. No images in the mode.

\textbf{Mode:} 0

\textbf{Number of Images:} N/A

\subsection{Dark Mode}

This mode runs with the shutter opened and the AOTF off. The scaling factor does not work on this function and the values are hard coded into the system. This mode does not use any wavelength values and the RF power is set at 0.

\textbf{Mode:} 1

\textbf{Number of Images:} 8

\begin{table}
    \begin{center}
    \begin{tabular}{|l|c|c|c|c|c|c|c|c|}
    \hline
    Image Number & 1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 \\
    \hline
    Exposure Time (s) & 0.05 & 0.10 & 0.50 & 1.00 & 2.00 & 3.00 & 5.00 & 10.00 \\
    \hline
    \end{tabular}
    \end{center}
    \caption[ALI Dark Science Mode Cycle]{ALI dark science mode cycle.}
    \label{tab:B.2:DarkScienceModes}
\end{table}


\subsection{Aerosol Mode}

This mode runs with the standard aerosol mode. An AOTF off mode is taken between each exposure Custom exposure time can be used. Scale factor can be used. Exposure time based of the standard calibration curve which can be seen in \autoref{TODO}.

\textbf{Mode:} 2

\textbf{Number of Images:} 26

\begin{table}
    \begin{center}
    \begin{tabular}{|l|c|c|c|c|c|c|c|c|c|c|}
    \hline
    Image Number & 1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 & 9 & 10 \\
    \hline
    Wavelength (nm) & 650 & 650 & 675 & 675 & 700 & 700 & 725 & 725 & 750 & 750 \\
    \hline
    RF Power & 0.0 & 1.0 & 0.0 & 1.0 & 0.0 & 1.0 & 0.0 & 1.0 & 0.0 & 0.9 \\
    \hline
    \end{tabular}
    \vspace{5mm}
    \begin{tabular}{|l|c|c|c|c|c|c|c|c|c|c|}
    \hline
    Image Number & 11 & 12 & 13 & 14 & 15 & 16 & 17 & 18 & 19 & 20 \\
    \hline
    Wavelength (nm) & 775 & 775 & 800 & 800 & 825 & 825 & 850 & 850 & 875 & 875 \\
    \hline
    RF Power & 0.0 & 0.9 & 0.0 & 1.0 & 0.0 & 1.0 & 0.0 & 1.0 & 0.0 & 1.0 \\
    \hline
    \end{tabular}
    \vspace{5mm}
    \begin{tabular}{|l|c|c|c|c|c|c|c|}
    \hline
    Image Number & 21 & 22 & 23 & 24 & 25 & 26 \\
    \hline
    Wavelength (nm) & 900 & 900 & 925 & 925 & 950 & 950 \\
    \hline
    RF Power & 0.0 & 1.0 & 0.0 & 1.0 & 0.0 & 1.0\\
    \hline
    \end{tabular}
    \end{center}
    \caption[ALI Aerosol Science Mode Cycle]{ALI aerosol science mode cycle.}
    \label{tab:B.2:AerosolScienceModes}
\end{table}

\subsection{H$_{2}$O Mode}

This mode runs with standard water vapour mode. An AOTF off mode is taken at the start and end of each cycle. Custom exposure times can be used. A scale factor can be used. Exposure time based off the standard calibration curve of the first wavelength of the cycle and constant for every image.

\textbf{Mode:} 3

\textbf{Number of Images:} 28

\begin{table}
    \begin{center}
    \begin{tabular}{|l|c|c|c|c|c|c|c|c|c|c|}
    \hline
    Image Number & 1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 & 9 & 10 \\
    \hline
    Wavelength (nm) & 920 & 920 & 922 & 924 & 926 & 928 & 930 & 932 & 934 & 936 \\
    \hline
    RF Power & 0.0 & 1.0 & 1.0 & 1.0 & 1.0 & 1.0 & 1.0 & 1.0 & 1.0 & 1.0 \\
    \hline
    \end{tabular}
    \vspace{5mm}
    \begin{tabular}{|l|c|c|c|c|c|c|c|c|c|c|}
    \hline
    Image Number & 11 & 12 & 13 & 14 & 15 & 16 & 17 & 18 & 19 & 20 \\
    \hline
    Wavelength (nm) & 938 & 940 & 942 & 944 & 946 & 948 & 950 & 952 & 954 & 956 \\
    \hline
    RF Power & 1.0 & 1.0 & 1.0 & 1.0 & 1.0 & 1.0 & 1.0 & 1.0 & 1.0 & 1.0 \\
    \hline
    \end{tabular}
    \vspace{5mm}
    \begin{tabular}{|l|c|c|c|c|c|c|c|c|c|}
    \hline
    Image Number & 21 & 22 & 23 & 24 & 25 & 26 & 27 & 28 \\
    \hline
    Wavelength (nm) & 958 & 960 & 962 & 964 & 966 & 968 & 970 & 970 \\
    \hline
    RF Power & 1.0 & 1.0 & 1.0 & 1.0 & 1.0 & 1.0 & 1.0 & 0.0 \\
    \hline
    \end{tabular}
    \end{center}
    \caption[ALI H$_{2}$O Science Mode Cycle]{ALI H$_{2}$O science mode cycle.}
    \label{tab:B.2:H2OScienceModes}
\end{table}

\subsection{O$_{2}$ Mode}

This mode runs with standard O2 mode. An AOTF off mode is taken at the start and end of each cycle. Custom exposure time can be used. A scale factor can be used. Exposure time based of the standard calibration curve of the first wavelength of the cycle and constant for every image.

\textbf{Mode:} 4

\textbf{Number of Images:} 20

\begin{table}
    \begin{center}
    \begin{tabular}{|l|c|c|c|c|c|c|c|c|c|c|}
    \hline
    Image Number & 1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 & 9 & 10 \\
    \hline
    Wavelength (nm) & 755 & 755 & 756 & 757 & 758 & 759 & 760 & 761 & 762 & 763 \\
    \hline
    RF Power & 0.0 & 1.0 & 1.0 & 1.0 & 1.0 & 1.0 & 1.0 & 1.0 & 1.0 & 1.0 \\
    \hline
    \end{tabular}
    \vspace{5mm}
    \begin{tabular}{|l|c|c|c|c|c|c|c|c|c|c|}
    \hline
    Image Number & 11 & 12 & 13 & 14 & 15 & 16 & 17 & 18 & 19 & 20 \\
    \hline
    Wavelength (nm) & 764 & 765 & 766 & 767 & 768 & 769 & 770 & 771 & 772 & 772 \\
    \hline
    RF Power & 1.0 & 1.0 & 1.0 & 1.0 & 1.0 & 1.0 & 1.0 & 1.0 & 1.0 & 0.0 \\
    \hline
    \end{tabular}
    \end{center}
    \caption[ALI O$_{2}$ Science Mode Cycle]{ALI O$_{2}$ science mode cycle.}
    \label{tab:B.2:O2ScienceModes}
\end{table}

\subsection{Custom Mode}

This mode runs lets the user upload a configuration to an extra config file on the ALI platform. The command is sent up via the \texttt{LdCusCnf} command. Details can be located in \autoref{sec:B.1:SoftwareCommands}.

\textbf{Mode:} 5

\textbf{Number of Images:} N/A

\subsection{Aerosol Constant Exposure Time Mode}

Same as the aerosol science mode except the exposure time has been set to two seconds for all exposures. The scaling factor is allied to this mode.

\textbf{Mode:} 6

\textbf{Number of Images:} 26

\section{List of Exposure Modes}
\label{sec:B.3:ExposureModes} 

ALI had two usable exposure modes during the campaign a calibrated exposure mode and a custom exposure mode which can be configured by the user. An automatic exposure mode was planned but due to time constraints never implemented. A brief description of the modes will follow.

\begin{table}
    \begin{center}
    \begin{tabular}{|l|l|}
    \hline
    Mode Number & Mode Name \\
    \hline
    0 & Invalid Mode \\
    \hline
    1 & Calibrated Exposure Mode \\
    \hline
    2 & Automatic Exposure Mode (\textit{Not Implemented}) \\
    \hline
    3 & Custom Exposure Mode \\
    \hline
    \end{tabular}
    \end{center}
    \caption[ALI Operational Exposure Time Modes]{ALI operational exposure time modes.}
    \label{tab:B.3:ExposureModes}
\end{table}

\subsection{Invalid Mode}

This mode is a nonexistent mode that has no operationial function and will not allow the science module to operate. No exposure times associated with this mode.

\textbf{Mode:} 0

\subsection{Calibrated Exposure Mode}

Using the method outlined in \autoref{sec:3.3:SystemTesting} the following is a table of the values determined for the calibrated exposure times. Any wavelength given in between and two calibrated wavelengths will use linear interpolation to determine the value for the exposure time to be used and any this less than 650~nm will use the 650~nm intigration time similar for wavelength past 950~nm.

\textbf{Mode:} 1

\begin{table}
    \begin{center}
    \begin{tabular}{|l|c|c|c|c|c|c|c|c|c|c|}
    \hline
    Wavelength (nm) & 650 & 755 & 756 & 757 & 758 & 759 & 760 & 761 & 762 & 763 \\
    \hline
    RF Power & 0.0 & 1.0 & 1.0 & 1.0 & 1.0 & 1.0 & 1.0 & 1.0 & 1.0 & 1.0 \\
    \hline
    \end{tabular}
    \vspace{5mm}
    \begin{tabular}{|l|c|c|c|c|c|c|c|c|c|c|}
    \hline
    Wavelength (nm) & 764 & 765 & 766 & 767 & 768 & 769 & 770 & 771 & 772 & 772 \\
    \hline
    RF Power & 1.0 & 1.0 & 1.0 & 1.0 & 1.0 & 1.0 & 1.0 & 1.0 & 1.0 & 0.0 \\
    \hline
    \end{tabular}
    \end{center}
    \caption[ALI Calibrated Exposure Times]{ALI calibrated exposure times.}
    \label{tab:B.2:O2ScienceModes}
\end{table}

\subsection{Custom Exposure Mode}

This mode runs lets the user upload a series of exposure times on the ALI platform to be used instead of the calibrated exposure mode.. The command is sent up via the \texttt{LdCusExp} command. Details can be located in \autoref{sec:B.1:SoftwareCommands}.

\textbf{Mode:} 3